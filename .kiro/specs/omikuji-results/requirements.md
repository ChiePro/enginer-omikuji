# Requirements Document

## Project Description (Input)
おみくじにいくつか種類があるのでおみくじごとに運勢に応じた結果を定義したい。1つのおみくじ・1つの運勢に複数の結果が用意されているイメージです。結果にはおみくじの内容や運勢とリンクした目をひくようなタイトルフレーズとその中身（説明など）を持ちたい。日本のおみくじのように結果にはいくつか項目を持たせてもいいかもしれない。またそれも視覚的に日本のおみくじのようにユーザーに見せることでおみくじを引いたようなUXを提供する。表現はユーモアさや厳しさなどの極端な運勢には極端な表現があるとより楽しめると思うのでそういった要件を詰めていきたい。

## 導入
エンジニア向けおみくじWebサービスにおいて、各おみくじの種類と運勢の組み合わせに対して多様で魅力的な結果を提供するシステム。日本の伝統的なおみくじの体験を現代的に再現し、エンジニアならではのユーモアと実用性を融合させた結果表示機能を実現する。

## Requirements

### Requirement 1: おみくじ結果データ管理
**Objective:** As a システム管理者, I want 各おみくじの種類と運勢に対して複数の結果バリエーションを外部ファイルで定義・管理する機能, so that ユーザーに多様で飽きのこない体験を提供できる

#### Acceptance Criteria
1. When システム管理者がおみくじ結果を定義する時、the おみくじ結果管理システム shall おみくじタイプごとに独立したJSONファイルでデータを管理する
2. When 結果データファイルが読み込まれる時、the おみくじ結果管理システム shall おみくじタイプ・運勢・結果IDの組み合わせで一意な結果を識別する
3. When 1つのおみくじタイプと運勢の組み合わせに対して複数の結果が定義されている時、the おみくじ結果管理システム shall 全ての結果を同一確率で選択可能な状態で保持する
4. The おみくじ結果管理システム shall 各結果に目を引くタイトルフレーズ（20-40文字）と詳細な説明内容（100-300文字）を含める
5. The おみくじ結果管理システム shall 日本の伝統的なおみくじ形式に基づく複数の項目（恋愛運、仕事運、健康運、金運、学業運）を各結果に含める
6. The おみくじ結果管理システム shall 既存のdata/fortune/ディレクトリ構造に準拠したファイル配置を使用する
7. The おみくじ結果管理システム shall 既存のドメイン層のRepositoryパターンと統合してファイルベースのデータアクセスを提供する

### Requirement 2: 結果選択ロジック
**Objective:** As a ユーザー, I want おみくじを引くたびに同じ運勢でも異なる結果が表示される機能, so that 何度でも楽しめる体験を得られる

#### Acceptance Criteria
1. When ユーザーが特定のおみくじタイプでおみくじを引く時、the おみくじ抽選システム shall 運勢決定後に該当する結果群から感情属性の重み付け確率に基づいて1つを選択する
2. When 同一の運勢に複数の結果が存在する時、the おみくじ抽選システム shall 運勢レベルに応じた感情属性確率分布を適用して選択する
3. If 指定されたおみくじタイプと運勢の組み合わせに結果が存在しない時、then the おみくじ抽選システム shall デフォルトの汎用結果を返す
4. The おみくじ抽選システム shall 既存のOmikujiDrawServiceと統合して動作する
5. The おみくじ抽選システム shall 各結果の感情属性（ポジティブ・ネガティブ・ニュートラル）を考慮した確率計算機能を提供する

### Requirement 3: 表現バリエーションシステム
**Objective:** As a ユーザー, I want 運勢の性質に応じた極端で印象的な表現を体験する機能, so that おみくじの楽しさと記憶に残る体験を得られる

#### Acceptance Criteria
1. When 大吉系の運勢が選択された時、the 表現システム shall 豪華で祝福的な表現とポジティブなユーモアを含む結果を提供する
2. When 凶・大凶系の運勢が選択された時、the 表現システム shall 厳しくも愛のある表現とエンジニア特有の自虐的ユーモアを含む結果を提供する
3. When 中間的な運勢が選択された時、the 表現システム shall バランスの取れた現実的な表現を提供する
4. The 表現システム shall エンジニア文化に特化したユーモアと専門用語を適切に活用する
5. The 表現システム shall 各結果に運勢レベルに応じた感情的強度を設定する

### Requirement 4: 日本式おみくじUI表現
**Objective:** As a ユーザー, I want 視覚的に日本の伝統的なおみくじと同様の体験を得られる機能, so that 親しみやすさと特別感のある結果表示を体験できる

#### Acceptance Criteria
1. When おみくじ結果が表示される時、the 結果表示システム shall 日本の神社のおみくじに類似した縦書きレイアウトで表示する
2. When 結果が表示される時、the 結果表示システム shall 運勢名を目立つ位置に和風デザインで表示する
3. When 複数の項目（恋愛運、仕事運等）が含まれる時、the 結果表示システム shall 各項目を視覚的に区別可能な形式で表示する
4. The 結果表示システム shall 運勢のレベルに応じた色彩とエフェクトで差別化を行う
5. The 結果表示システム shall 既存のTailwind CSSとFramer Motionを活用したアニメーション演出を含める
6. The 結果表示システム shall レスポンシブデザインでモバイル・デスクトップ両方に対応する

### Requirement 5: おみくじ結果コンテンツ定義
**Objective:** As a コンテンツ企画者, I want エンジニア向けに特化した魅力的で実用的なおみくじ結果コンテンツを定義する機能, so that ユーザーに満足度の高い体験を提供できる

#### Acceptance Criteria
1. When エンジニア運勢おみくじの大吉結果が生成される時、the 結果コンテンツシステム shall 以下のサンプル形式に準拠した内容を提供する：「今日は神コードが降臨する日」「バグ0でリリース成功、技術選定も完璧、同僚からの評価もMAX」
2. When エンジニア運勢おみくじの凶結果が生成される時、the 結果コンテンツシステム shall 以下のサンプル形式に準拠した内容を提供する：「今日は404 Not Foundの日」「コンパイルエラー頻発、デプロイ失敗必至、ただし学びの機会と捉えよ」
3. The 結果コンテンツシステム shall 各運勢レベルに対して最低3つの結果バリエーションを用意する
4. The 結果コンテンツシステム shall 各結果の恋愛運にエンジニア文化を反映した表現（「ペアプロで距離が縮まる」「GitHubのフォロワー急増」等）を含める
5. The 結果コンテンツシステム shall 仕事運にプログラミング関連の具体的な内容（「コードレビューが一発承認」「新技術習得チャンス到来」等）を含める
6. The 結果コンテンツシステム shall 金運に技術者向けの表現（「副業案件獲得」「ストックオプション上昇」等）を含める
7. The 結果コンテンツシステム shall 健康運にデスクワーカー向けアドバイス（「良い椅子との出会い」「目の疲れ軽減」等）を含める
8. The 結果コンテンツシステム shall 学業運に技術学習関連の内容（「新フレームワーク理解が進む」「アーキテクチャ設計スキル向上」等）を含める
9. The 結果コンテンツシステム shall 各結果コンテンツにポジティブ・ネガティブ・ニュートラルの感情属性を定義する
10. When 大吉・中吉系の運勢が選択された時、the 結果選択システム shall ポジティブ属性のコンテンツを80%、ニュートラル属性を15%、ネガティブ属性を5%の確率で選択する
11. When 小吉・吉系の運勢が選択された時、the 結果選択システム shall ポジティブ属性のコンテンツを60%、ニュートラル属性を30%、ネガティブ属性を10%の確率で選択する
12. When 末吉系の運勢が選択された時、the 結果選択システム shall ニュートラル属性のコンテンツを50%、ポジティブ属性を30%、ネガティブ属性を20%の確率で選択する
13. When 凶・大凶系の運勢が選択された時、the 結果選択システム shall ネガティブ属性のコンテンツを60%、ニュートラル属性を25%、ポジティブ属性を15%の確率で選択する
14. The 結果コンテンツシステム shall 各感情属性について以下のサンプルに準拠した内容を用意する：
    - ポジティブ：「チーム開発が絶好調」「新技術をマスター」「バグなしコミット達成」
    - ニュートラル：「通常運転の一日」「着実な進歩を実感」「安定したパフォーマンス」  
    - ネガティブ：「デバッグ地獄の予感」「マージコンフリクト多発」「レビュー指摘事項山積み」
15. The 結果コンテンツシステム shall エンジニア特有の技術愛による「気持ち悪さ」を含む表現を適度に含める
16. The 結果コンテンツシステム shall 健康運に技術的興奮による生理現象表現（「技術書籍を読んでセロトニン大量発生！」「新フレームワークでドーパミン過多」「完璧なアーキテクチャでアドレナリン分泌」等）を含める
17. The 結果コンテンツシステム shall 恋愛運に技術オタク特有の表現（「GitHubのcommit履歴で愛を語る日」「ペアプロ中に心拍数が上昇」「コードの美しさに恋に落ちる」等）を含める
18. The 結果コンテンツシステム shall 仕事運に技術者の異常な喜び表現（「リファクタリングで脳汁大放出」「エラーハンドリングで無限の快感」「CI/CDパイプラインに魂を捧ぐ」等）を含める

### Requirement 6: 既存システム統合
**Objective:** As a 開発者, I want 新しい結果システムが既存のおみくじ機能とシームレスに統合される機能, so that 一貫性のあるユーザー体験と保守性を確保できる

#### Acceptance Criteria
1. When 新しい結果システムが実装される時、the システム統合層 shall 既存のOmikujiType値オブジェクトと互換性を保持する
2. When 結果データが必要になる時、the システム統合層 shall 既存のRepositoryパターンを拡張して結果データを提供する
3. The システム統合層 shall 既存のAPI Routes（/api/omikuji/）を拡張して結果取得機能を追加する
4. The システム統合層 shall 既存のTypeScript型定義を拡張して新しい結果構造に対応する
5. The システム統合層 shall 既存のテスト基盤（Vitest + React Testing Library）と統合したテストを提供する
6. When 新機能が実装される時、then the システム shall 既存の運勢タイプ（data/fortune/fortune-types.json）との後方互換性を維持する
